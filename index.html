<html>

<head>
  <title>Dear Diary</title>
  <link rel="stylesheet" href="index.css">
  <link rel="icon" href="alt.ico" />
  <script src="entry.js"></script>
  <script src="entries.js"></script>

  <script>
    const one_day_in_millis = 1000 * 60 * 60 * 24

    function getParameterByName(name, url) {
      if (!url) {
        url = window.location.href;
      }
      name = name.replace(/[[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }


    const renderEntry = (parent, entry) => {


      const ele = document.createElement("div");
      ele.className = "entry";
      const container = document.createElement("div");
      container.id = "container";


      const text = document.createElement("div");
      text.innerHTML = entry.text;
      text.className = "text";
      const icon = document.createElement("img");
      //icon.src = entry.icon;
      icon.style.backgroundColor = "rgba(220,243,255,0.3)";
      icon.className = "icon";
      const title = document.createElement("h2");
      title.className = "title";
      title.innerHTML = entry.title;
      const date = document.createElement("div");
      date.className = "date";
      date.innerHTML = "July 10th, 2008";
      const wordsContainer = document.createElement("div");
      wordsContainer.id = "words-container";

      const label = document.createElement("span");
      label.className = "label";
      label.innerHTML = `Mood:`;

      const words = document.createElement("span");
      words.className = "words";
      words.innerHTML = "Meloncholy"
      wordsContainer.append(label);
      wordsContainer.append(words);

      container.append(icon);
      container.append(text);

      ele.append(title);
      ele.append(date);
      ele.append(container);

      ele.append(wordsContainer);

      parent.append(ele);
    }

    /*
      get todays' date. 
       figure out how many days its been since the first day of the last even month
       once i have that number, go through all entries
       if the entry's date is >= todays number, render it

       this should loop on a two month cycle

       the point is both to have a kind of 'dracula daily' vibe
       and so that if you visit once you're unlikely to get the full story
       or even know you're missing anything

       and if you visit later it will be DIFFERENT and you won't know why
       unless you waste
    */
    const renderEntriesTillToday = () => {
      renderEntry(document.querySelector("#journal"), riaEntry);
      renderEntry(document.querySelector("#journal"), entry);

    }

    window.onload = () => {
      const today = new Date();
      if((today.getDate()===10 && today.getMonth()===6) || getParameterByName("truth",null)){ //0 is january
        renderEntriesTillToday();
      }else if((today.getDate()===4 && today.getMonth()===11) || getParameterByName("truth",null)){ //0 is january){
        renderEntriesTillToday();
      }else{
        const ele = document.createElement("div");
        ele.innerHTML = "This User has not made a post yet! Say 'Hi'!";
        document.querySelector("#journal").append(ele);
      }
    }
  </script>
</head>


<body>
  <h1 id="title">Witherby</h1>
  <div id="journal">

  </div>

</body>

</html>